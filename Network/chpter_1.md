# Webブラウザ

## HTTPリクエスト・レスポンス

ブラウザの最初の仕事はWebサーバーにリクエストを送る為に、URLを解読する。<br>

URLの要素<br>
http:(プロトコル) + // + Webサーバー名 + / + ディレクトリ名 + / + ファイル名<br> 

具体例<br>
http://ww.lab.glasscom.com/dir1/file1.html<br>

HTTPとは... クライアントとサーバーがやり取りするメッセージの内容や手順について定めたもの<br>

### HTTPの簡単な流れ

1. クライアントからサーバーに向けてリクエストのメッセージを送る。

メッセージの中には、「何」を「どうして」ほしいのかが書いてある。<br>

「何」... URI(ファイル名やURLなどのアクセス先)<br>
「どうして」... メソッド(サーバーにどのような動作をしてほしいのかを伝える)<br>
主要なメソッド<br>
GET... URIで指定した情報を取り出す<br>
POST... クライアントからサーバーにデータを送信する。<br>

2. リクエストメッセージがサーバーに届いたら、要求にしたがって動作し、その結果生じるデータをレスポンスメッセージに格納する

先頭部分には、実行結果が正常終了したか、異常が起こったかを表すステータスコードがある。<br>

ステータスコードの例<br>
「404 Not Found」... サーバーにアクセスしたときにファイルが見つからない。

### HTTPのリクエストメッセージを作る

URLの解読し、Webサーバーとファイル名が判明したら、ブラウザはそれを基にHTTPリクエストメッセージを作成する。

HTTPリクエストのフォーマット<br>

1行目<br>

リクエストライン  <メソッド><空白><URI><空白><HTTPバージョン> #リクエストの大まかな内容<br>

2行目~数行から10数行程度<br> 

メッセージ・ヘッダー   #付加的な細かい情報を書き留めておく(日付、クライアントが扱えるデータの種類、言語など)<br>

空白が1行<br>

空白の後<br>
メッセージ・ボディ #メッセージの本体、送信するデータ<br>
メソッドがGETの場合はメソッドとURIのみで何をすべきか判断できるので、メッセージボディに書く送信データは無し。<br>
メソッドがPOSTの場合はフォームに入力したデータをメッセージボディの部分に書く。<br>

画像ファイルがある場合は、文書ファイルのリクエストと画像ファイルのリクエストの両方、送信する。<br>
画像が2枚ある文書ファイルの場合、文書ファイルで1回、画像ファイルで2回の合計3回リクエストメッセージを送信する。

### リクエストを送るとレスポンスが帰ってくる

リクエストを送るとWebサーバーからレスポンスメッセージが返ってくる。<br>
レスポンス・メッセージのフォーマットも基本的な考え方はリクエスト・メッセージと同じだが、1行目のみ違う。<br>
レスポンスメッセージの場合は、正常終了したのかエラーが起きたのかといったリクエストの実行結果をを表すステータスコードとレスポンスフレーズを1行目に書くことになっている。<br>

ステータスコードとレスポンスフレーズは同じ内容を表すが用途が違う。<br>

ステータスコード→数字で書いたもの。主に、プログラムなどに実行結果を知らせる目的を持っている。<br>
レスポンスフレーズ→文章で書いたもの。主に、人間に実行結果を知らせる目的を持っている。<br>

レスポンスメッセージが帰ってきたら、そこからデータを取り出して、画面に表示する。<br>

ステータスコードの概要<br>
| コード | 説明                              |
| ------ | --------------------------------- |
| 1xx    | 処理の経過状況をなどを通知する      |
| 2xx    | 正常終了                          |
| 3xx    | 何らかのアクションが必要であることを表す |
| 4xx    | クライアント側のエラー              |
| 5xx    | サーバー側のエラー                  |


## WebサーバーのIPアドレスをDNSサーバーに問い合わせる

### IPアドレスの基本

HTTPメッセージを作成したら、それをOSに依頼してWebサーバーに送信してもらう。<br>
その際に、ブラウザはURLのサーバードメインからIPアドレスを調べる必要がある。<br>
(OSに送信を依頼するときは、ドメイン名ではなくIPアドレスでメッセージを届ける必要があるため)<br>

ネットワークはサブネットという小さなネットワークを一つの単位と考え、それをルーターで接続することによって全体のネットワークが出来上がっている。<br>
サブネットの例:ハブに何台かのパソコンが接続されたもの<br>

ネットワークに対して、「○○丁目▽▽番地」というような恰好でネットワークの住所ともいえるアドレスを割り当てる。<br>
「○○丁目」に相当する番号をサブネットに割り当てる→ネットワーク番号<br>
「▽▽番地」に相当する番号をコンピュータ(パソコンなど)に割り当てる→ホスト番号<br>

ITアドレスは32ビットのデジタルデータでそれを8ビットずつドットで区切って10進数で表記する<br>
例:10.11.12.13

上記はネットワーク番号とホスト番号の二つを合わせており、この情報のみだとどこからどこまでがネットワーク番号、ホスト番号というのが分からない。<br>
内訳を表す情報を必要に応じてIPアドレスに付加する。→ネットマスク<br>

ネットマスクも32ビットのデジタルデータ。<br>
11111111.11111111.11111111.00000000<br>
1がネットワーク部分、0がホスト部分、下記は上記を10進数に直したもの<br>
255.255.255.0<br>
そして、IPアドレスにネットマスク情報を付加したもの<br>
10.11.12.13/24 →24はネットワーク部分のビット数<br>

ホスト部分が全て0→サブネット自体<br>
ホスト部分が全て1→サブネット上にある機器全員にパケットを送るブロードキャストを表す。

### ドメイン名とIPアドレス

ドメイン名→覚えやすい、分かりやすいがデータ量が増えてしまい、データを運ぶのに余分な時間がかかる<br>
IPアドレス→覚えにくい、分かりにくいがデータ量は32ビットしかない。<br>

→人間はドメイン名、コンピュータはIPアドレス
→双方を変換する仕組みがDNS

### DNS

ブラウザは、DNSサーバーにドメイン名で問合せをし、IPアドレスが返ってくる(名前解決やネーム・リゾリューションと呼ぶ)

DNSサーバーへの問い合わせ方<br>

(DNS)リゾルバ→DNSサーバーに対してクライアントとして動作するもの

リゾルバの実態はSocketライブラリに入っている部品化したプログラム<br>

Socketライブラリ→OSに組み込まれているネットワーク機能をアプリから呼びだす為のプログラムの部品を集めたもの。









